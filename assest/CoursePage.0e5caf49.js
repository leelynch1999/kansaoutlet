import{s as a,aj as h,o as F,q as w}from"./vendor.d944feed.js";import{u as R,a as k,b as M,H as b,g as S,C as N}from"./index.fac359f5.js";const v="courses-display-app-prod",f="fe_env";function T(){a.exports.useEffect(()=>{const e=document.createElement("script");return e.type="module",e.src=`https://jss.getresponse.com/js/bootstrap.js?app=mobile-editor&env=${$()}`,document.head.appendChild(e),()=>e.remove()},[])}function $(){if(typeof document>"u")return v;const e=new URLSearchParams(document.location.search);return e.has(f)?e.get(f):document.cookie.split(";").map(o=>o.trim().split("=")).find(o=>o[0]===f)?.[1]??v}const x="@getrevenue/display";function B(){return typeof grImportApp<"u"?grImportApp(x):new Promise(e=>{globalThis.onGrUniversalBootstrapLoad=o=>o(x).then(r=>e(r))})}function H(e,o,r,c){c??=document;let s=c.querySelector(e);s||(s=o(),c.appendChild(s)),r(s)}function P(e,o){return H(`meta[name="${e}"]`,()=>document.createElement("meta"),r=>Object.assign(r,{name:e,content:o}),document.head)}function L(e,o){const r=R(),c=k(),[s,C]=a.exports.useState(null),[m,j]=a.exports.useState(null),[d,E]=a.exports.useState(!1),[i,g]=a.exports.useState(!1),[l,U]=a.exports.useState(null),A=M(),D=a.exports.useRef(A);T(),a.exports.useEffect(()=>{!i||(async()=>{try{const t=await r.courses.getContent(e);t.ensureSuccess(),C(await t.json())}catch(t){throw alert(`Failed to fetch course: ${t}`),t}})()},[r.courses,e,i]),a.exports.useEffect(()=>{!i||(async()=>{try{const t=await r.courses.getProgress(e);t.ok&&j(await t.json()),t.ok||t.status===b.Gone||t.status===b.NotFound?E(!0):t.ensureSuccess()}catch(t){throw alert(`Failed to fetch progress: ${t}`),t}})()},[r.courses,e,i]),a.exports.useEffect(()=>{const t=B();if(s===null||d===!1||!i)return;let y;return(async()=>y=(await t).mount(o.current,{content:JSON.parse(s.content),name:s.name,progress:m??{},buyCourseUrl(n){return h(S("course-buy-page"),{courseId:n})},saveProgress(n,u,p){return r.courses.saveProgress(n,u,p)},async getVideo(n){const u=await r.courses.getVideo(s.videoLibraryId,n);return u.ensureSuccess(),u.json()},intl:{formatDate(n){return D.current.formatDate(n)}},visitor:l?{email:l.email,firstName:l.firstName,lastName:l.lastName}:null,async getWebinar(n){const u=await r.webinar.getById(n);return u.ensureSuccess(),u.json()},async submitWebinar(n,u){const p=await r.webinar.submitForm(n,{customFields:[],pageId:e,formId:`course:${e}`,...u});return p.ensureSuccess(),await p.json()},onCompleted(){const n=s.navigationUrl===null?h(S("courses-finished-page"),{slug:e}):s.navigationUrl;window.location.assign(n)}}).unmount)(),()=>y?.()},[r.courses,o,s,d,m,l,i,r.webinar,e]),a.exports.useEffect(()=>{!s||(s.seoTitle&&(document.title=s.seoTitle),s.seoDescription&&P("description",s.seoDescription),s.seoKeywords&&P("keywords",s.seoKeywords.replaceAll(`
`,",")))},[s]),a.exports.useEffect(()=>c.subscribe(t=>{g(!0),U(t)},()=>g(!0)),[c])}function G(e){const o=a.exports.useRef(null);return L(e.match.params.courseId,o),F("div",{id:"course-content-root",children:[w(N,{}),w("div",{id:"course-app",ref:o})]})}export{G as default};
